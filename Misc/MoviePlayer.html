<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Movie Player</title>
  <style>
    body { background-color: black; color: white; font-family: Arial, sans-serif; text-align: center; margin: 0; padding: 0; }
    .top-bar { display:flex; justify-content:center; align-items:center; gap:10px; padding:15px; background-color:#000; border-bottom:2px solid #222; flex-wrap:wrap;}
    button,input { border:none; border-radius:4px; padding:6px 10px; font-size:14px; }
    #backBtn { background-color:#005eff; color:white; cursor:pointer; }
    #backBtn:hover { background-color:#0074ff; }
    #search { background-color:#002bff; color:white; width:150px; outline:none; }
    .content { background-color:#0000a8; margin:20px auto; padding:20px; width:80%; max-width:800px; border-radius:6px; }
    #movie-buttons { display:grid; grid-template-columns:repeat(auto-fill, minmax(160px,1fr)); gap:10px; }
    .movie-btn { background-color:#3355ff; color:white; border:none; padding:8px 10px; border-radius:4px; cursor:pointer; line-height:1.2; font-size:14px; min-height:40px; }
    .movie-btn:hover { background-color:#1e40ff; }
    iframe { margin-top:20px; width:100%; height:480px; border-radius:6px; border:none; }
  </style>
</head>
<body>
  <div class="top-bar">
    <button id="backBtn">‚Üê Back</button>
    <h1>Movie Player</h1>
    <label for="search"><strong>Search:</strong></label>
    <input type="text" id="search" placeholder="Search movies...">
  </div>

  <div class="content">
    <h2>Available Movies</h2>
    <div id="movie-buttons">Loading movies...</div>
    <iframe id="playerIframe"></iframe>
  </div>

  <script>
    const container = document.getElementById("movie-buttons");
    const playerIframe = document.getElementById("playerIframe");
    const searchInput = document.getElementById("search");

    let movies = [];

    async function loadMovies() {
      container.textContent = "Loading movies...";
      try {
        const res = await fetch("https://gist.githubusercontent.com/ajxanman-beep/19e0dc37ea7d2a7a3b680a5d89a18243/raw/movies.json");
        const data = await res.json();

        // Convert each Drive ID to a preview iframe URL
        movies = data.map(m => ({
          label: m.label,
          url: `https://drive.google.com/file/d/${m.id}/preview`
        }));

        displayMovies(movies);

        searchInput.addEventListener("input", () => {
          const q = searchInput.value.toLowerCase();
          const filtered = movies.filter(m => m.label.toLowerCase().includes(q));
          displayMovies(filtered);
        });

      } catch (err) {
        container.textContent = "Error loading movies.";
        console.error(err);
      }
    }

    function displayMovies(list) {
      container.innerHTML = "";
      if(list.length === 0) { container.textContent = "No movies found."; return; }
      list.sort((a,b)=>a.label.localeCompare(b.label));
      list.forEach(movie => {
        const btn = document.createElement("button");
        btn.textContent = movie.label;
        btn.className = "movie-btn";
        btn.onclick = () => { playerIframe.src = movie.url; };
        container.appendChild(btn);
      });
    }

    document.getElementById("backBtn").addEventListener("click", () => {
      window.location.href = "../index.html";
    });

    loadMovies();
  </script>
</body>
</html>
